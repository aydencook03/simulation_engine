# TODO / IDEAS

- Short Term
  - [X] develop a good abstraction/api for constraints
  - [ ] doc comment for Constraint
    - [ ] comment explaining math and equations of XPBD
    - [ ] static vs non-static, xpbd vs non-xpbd
    - [ ] how to derive constraint force from lagrange multiplier
  - [X] simplify the abstraction/api for fields
    - [X] remove dt
    - [X] mimick constraint api. ie: Field trait: evolve, energy. SimpleFieldData, ParticleParticle, FieldParticle
  - [X] account for N's 3rd law in the ParticleParticle interaction (can enable optimizations?)
  - [ ] investigate
    - [ ] read xpbd paper. understand mathematical derivation to see where my algorithm could come from
    - [ ] cantilever beam w/ xpbd vs w/out
    - [ ] derive constraint function for other potentials (like gravity?) (learn how to from neo-hookean paper)
    - [ ] why does non-xpbd conserve angular momentum while xpbd does not?
    - [ ] why does non-xpbd conserve kinetic energy while xpbd does not?
    - [ ] step through non-xpbd algorithm w/ variables to prove the conservation of quantities
    - [ ] what is the physical correspondance to the xpbd dissipation? what is its behavior in relation to compliance?
  - [ ] real-time 3d renderer w/ simple interaction (using bevy)
  - [X] support breakable constraints (max constraint force and broken properties)
  - [X] non-dynamical particles (central gravity bodies, boundary particles, constraint & spring attachments, platforms, etc.)
  - [ ] a common functionality implementation of SPH smoothing
    - [ ] different smoothing kernels & their gradient, divergence, laplacian, etc
    - [ ] different modifications to the kernels for certain symmetries and properties
    - [ ] different boundary conditions
  - [X] builder methods for builtin fields & constraints
  - [X] fix BoxBound instability
  - [ ] a general purpose (common functionality) Mesh object
    - [ ] different types:
      - [ ] structured (FDM, FVM, FEM)
        - [ ] 2d: orthogonal quadrilateral / lattice graph. 3d: hexahedral
      - [ ] unstructured (FVM, FEM)
        - [ ] 2d: quadrilateral, triangular. 3d: tetrahedral
        - [ ] surface mesh
    - [ ] mesh <=> connected particles
    - [ ] different boundary conditions (Neumann, dirichet, etc)
    - [ ] mpm algorithms implemented on it?

- Big Picture
  - math
    - [X] pi
    - [X] point
    - [X] vector
    - [X] matrix
  - objects:
    - [X] system
    - [X] particles
    - [ ] rigid bodies
    - [ ] mesh
      - [ ] structured
        - [ ] differential operators
      - [ ] unstructured
  - dynamics & interactions:
    - [ ] forces
      - [ ] generic
      - [ ] field interaction
      - [ ] pair-wise interaction
      - [ ] simple force
    - [ ] xpbd compliant constraints
    - [ ] sph, mpm
    - [ ] collisions
    - [ ] thermodynamics
    - [ ] boundary conditions
      - [ ] sources & sinks
      - [ ] inlet
      - [ ] outlet
      - [ ] no-slip
      - [ ] constant pressure
      - [ ] symmetric
      - [ ] periodic
      - [ ] rigid / fixed
  - algorithms:
    - [ ] n-body pairing (take a generic slice and return an iterator)
    - [ ] composite shapes (rigid body <-> collection of particles)
    - [ ] Barnesâ€“Hut algorithm
    - [ ] collision detection & neighbor finding
      - [ ] spatial dividing (octree)
      - [ ] hashmap
  - features:
    - [ ] rendering
    - [ ] serialization/deserialization
    - [ ] simd
    - [ ] wasm
    - [ ] parallelization
    - [ ] gpu acceleration

- Examples
  - [ ] cantilever
  - [ ] pile of blocks
  - [ ] cloth
  - [ ] jello block
  - [ ] planet collision
  - [ ] dam break
  - [ ] pile of sand

- Fields
  - [ ] interatomic / intermolecular potentials
    - [X] electrostatic (Coulomb) force
    - [X] general Lennard-Jones potential (Mie potential)
    - [ ] Morse potential
    - [ ] many-body potentials
  - [ ] particle-mesh-method newtonian gravity
  - [ ] SPH newtonian gravity mesh
  - [ ] electromagnetic
  - [ ] material point method mesh
  - [ ] rayleigh dissipation function

- Constraints / Position Based Dynamics
  - [X] compliance, rayleigh dissipation / damping
  - [X] stretching (for young's modulus)
  - [ ] bending
  - [ ] isometric bending?
  - [ ] particle-triangle collisions
  - [X] contact plane collisions (for general purpose shapes & environment)
    - [ ] w/ friction (small steps, survey of pbd, rigid bodies, using average velocity)
  - [X] particle-particle non-penetration
    - [ ] w/ friction (small steps, survey of pbd, rigid bodies, using average velocity)
  - [ ] tetrahedral volume conservation (for bulk modulus) (use neo-hookean bc it doesn't need polar decomposition?)
  - [ ] triangle area conservation
  - [ ] shear (for shear modulus)
  - [ ] neo-hookean soft body (tetrahedral hydrostatic constraint & deviatoric constraint)
  - [ ] closed triangle mesh overpressure
  - [ ] fluid w/ surface tension, cohesion, viscosity
  - [ ] cloth drag
  - [ ] shape matching for soft/rigid bodies
  - [ ] generic constraint API
    - see what common behavior can be consolidated into the constraint trait

- Collision Handling
  - [ ] collision / impulse forces
  - [ ] friction
  - [ ] viscosity

- Thermodynamics
  - [ ] research how to implement a good general macroscopic thermodynamics model
  - [ ] is both orientation & size needed for proper thermodyanamics, or only size?
  - [ ] conduction, advection, radiation, friction, collisions
  - [ ] state variables & state equations
    - what is needed in this engine? pos, vel, temp, radius?
    - pressure/volume, temperature/entropy, internal energy, work, heat
    - fields can alter any of these state variables. a field could implement a certain state eqn?
  - [ ] thermal expansion
  - [ ] phase changes

- Compilation Features
  - [ ] serialization of System struct and saving/loading from file (using serde)
  - [ ] load and run a serialized system from the command line (create folder of serialized examples)
  - [ ] object mesh file loading (for FEM-like analysis)?
  - [ ] parallelize using simd, rayon, bevy_tasks::ParallelIterator, etc
  - [ ] wgpu acceleration

- Rendering
  - [ ] animation baking (both 3d and 2d)
    - [ ] save/serialize System state to file once the animation is completed
  - [ ] color based on radiation/temperature
  - [ ] good 3d rendering
    - [ ] isosurface/isoline rendering?
    - [ ] sph-like smoothing

- Physics
  - [ ] intermolecular forces & interatomic potentials from molecular mechanics
    - [ ] solids (covalent/ionic/metallic bonds)
      - [ ] covalent bond potential, electrostatic attraction
      - [X] xpbd distance constraints w/ compliance (harmonic oscillator)
      - [ ] smoothed-particle-hydrodynamics
      - [ ] material-point-method
    - [ ] liquids & gases (intermolecular forces & hydrogen bonds)
      - [X] Lennard-Jones 6-12, 6-9, 10-12 (Mie), electrostatic attraction
      - [ ] smoothed-particle-hydrodynamics
      - [ ] material-point-method
      - [ ] position-based-fluids
  - [ ] soft bodies
    - [ ] volume conserving, pnuematic, etc
  - [ ] plastic deformation (break constraint and then create a new one in the new location?)
  - [ ] bouncy objects
  - [ ] granular materials
  - [ ] extend engine to support rigid bodies (a particle with orientation, shape, inertia) (like bullet, rapier, xpbd, etc)